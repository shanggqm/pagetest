<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP协议Roadmap：Agent Graphs与Interactive Workflows</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
    <style>
        :root {
            --bg-dark: #121212;
            --card-bg: #1e1e1e;
            --accent: #6c5ce7;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --border: #333;
            --highlight: #8a61ff;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.7;
            padding-bottom: 60px;
        }
        
        .container {
            max-width: 1200px;
        }
        
        h1, h2, h3, h4 {
            color: white;
            font-weight: 600;
        }
        
        h1 {
            font-size: 2.6rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(90deg, var(--accent), #a29bfe);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }
        
        h2 {
            font-size: 1.8rem;
            margin-top: 2.5rem;
            margin-bottom: 1.2rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
        }
        
        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            color: var(--accent);
        }
        
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            margin-bottom: 25px;
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }
        
        .card-header {
            background-color: rgba(108, 92, 231, 0.1);
            border-bottom: 1px solid var(--border);
            font-weight: 600;
            padding: 15px 20px;
        }
        
        .card-body {
            padding: 25px;
        }
        
        ul, ol {
            padding-left: 1.5rem;
        }
        
        li {
            margin-bottom: 0.5rem;
        }
        
        .separator {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 40px 0;
            color: var(--text-secondary);
        }
        
        .separator::before, .separator::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid var(--border);
        }
        
        .separator::before {
            margin-right: 1em;
        }
        
        .separator::after {
            margin-left: 1em;
        }
        
        .tag {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            background-color: rgba(108, 92, 231, 0.2);
            color: var(--accent);
            border-radius: 30px;
            font-size: 0.85rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .image-container {
            margin: 30px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .image-container img {
            width: 100%;
            height: auto;
        }
        
        table {
            width: 100%;
            margin-bottom: 2rem;
            color: var(--text-primary);
            border-collapse: separate;
            border-spacing: 0;
        }
        
        table th, table td {
            padding: 12px 15px;
            border: none;
            border-bottom: 1px solid var(--border);
        }
        
        table th {
            background-color: rgba(108, 92, 231, 0.1);
            font-weight: 600;
            text-align: left;
        }
        
        .section-title {
            display: inline-flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
            color: var(--accent);
        }
        
        .bg-gradient {
            background: linear-gradient(120deg, rgba(108, 92, 231, 0.2), rgba(90, 92, 231, 0), rgba(108, 92, 231, 0.1));
            padding: 40px 30px;
            border-radius: 12px;
            margin: 40px 0;
        }
        
        blockquote {
            border-left: 4px solid var(--accent);
            padding-left: 20px;
            margin-left: 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        .highlight-text {
            color: var(--highlight);
            font-weight: 500;
        }
        
        code {
            background-color: rgba(108, 92, 231, 0.1);
            color: #a29bfe;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: 'SF Mono', Menlo, Monaco, Consolas, monospace;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .card-body {
                padding: 15px;
            }
        }
        
        .evolution-stages {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }
        
        .evolution-stages::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), #a29bfe);
            z-index: 0;
        }
        
        .evolution-stage {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            width: 30%;
            text-align: center;
            position: relative;
            z-index: 1;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .evolution-stage .icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--accent);
            margin: -35px auto 15px;
            font-size: 1.5rem;
        }
        
        .evolution-stage h4 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .dark-text-fix {
            color: var(--text-primary) !important;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div data-aos="fade-up">
            <h1>MCP协议Roadmap：Agent Graphs与Interactive Workflows</h1>
            
            <div class="image-container" data-aos="zoom-in">
                <img src="mcp_mode.jpg" alt="MCP应用架构演进图" class="img-fluid">
            </div>
            
            <div class="evolution-stages" data-aos="fade-up">
                <div class="evolution-stage">
                    <div class="icon"><i class="fas fa-cube"></i></div>
                    <h4>单层模式</h4>
                    <p class="dark-text-fix">单个MCP Host与多个独立MCP Server连接，每个服务提供独立工具集，存在命名冲突和工具重复问题。</p>
                </div>
                
                <div class="evolution-stage">
                    <div class="icon"><i class="fas fa-cubes"></i></div>
                    <h4>嵌套模式</h4>
                    <p class="dark-text-fix">引入Gateway层，实现层级调用和工具聚合，但仍缺乏统一命名空间和跨层通信标准，导致上下文传递问题。</p>
                </div>
                
                <div class="evolution-stage">
                    <div class="icon"><i class="fas fa-project-diagram"></i></div>
                    <h4>网络模式</h4>
                    <p class="dark-text-fix">全连接网络结构，每个节点既可作为Host也可作为Server，需要完整的命名空间、路由机制和循环调用控制方案。</p>
                </div>
            </div>
            
            <p class="lead dark-text-fix" data-aos="fade-up">
                如上图所示，MCP正从简单的单层调用模式，向复杂的网状分布式架构演进。这种演化路径直接催生了Agent Graphs规范的需求：当智能体数量增加、调用层级加深，必须解决<span class="highlight-text">命名冲突、上下文传递、循环引用和预算控制</span>等基础问题。正是这一背景下，过去3周更新的MCP Roadmap把Agent Graphs与Interactive Workflows放在"Agent"章节里，意味着接下来半年MCP会从"单点工具调用协议"升级为支持<span class="highlight-text">多智能体拓扑 + 人在环审批</span>的完整编排层。这两个方向分别解决：① 当多个MCP服务器/智能体需要层级协作时的命名冲突、上下文转发与循环调用；② 当模型要"做大事"而必须征得用户授权或补充信息时的权限、对话格式与UI标准化。
            </p>
        </div>
        
        <div class="separator" data-aos="fade">⸻</div>
        
        <section data-aos="fade-up">
            <h2 class="section-title"><i class="fas fa-network-wired"></i> Agent Graphs</h2>
            
            <div class="card" data-aos="fade-up">
                <div class="card-header">背景与动机</div>
                <div class="card-body">
                    <ul>
                        <li>Roadmap明确提出"通过namespacing与graph-aware communication patterns支持复杂智能体拓扑"。</li>
                        <li>社区讨论指出，一旦一个"服务器-聚合器"同时代理多台MCP服务器，就会出现命名冲突、增量更新、OAuth级联等问题，需要引入层级namespace、路由与链路追踪。</li>
                        <li>Blog分析把这一演进视作"从链到图"，认为MCP将与LangGraph、Reactor等框架汇流，成为"AI版OpenAPI + gRPC"。</li>
                    </ul>
                </div>
            </div>
            
            <h3>设计要素（从提案与PR摘要提炼）</h3>
            
            <div class="table-responsive" data-aos="fade-up">
                <table class="table">
                    <thead>
                        <tr>
                            <th>要素</th>
                            <th>目标</th>
                            <th>典型实现思路</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>层级命名</td>
                            <td>避免Tool/Prompt重名</td>
                            <td>反向域名或org/tool前缀，支持批量tools/list过滤</td>
                        </tr>
                        <tr>
                            <td>代理路由</td>
                            <td>在深层调用链中保持上下文 & 预算</td>
                            <td>每层代理追加path, budget, trace-id元数据</td>
                        </tr>
                        <tr>
                            <td>递归通知</td>
                            <td>深层节点可把进度、局部结果向上传</td>
                            <td>扩展notifications/progress支持chunk、partial字段</td>
                        </tr>
                        <tr>
                            <td>观测性</td>
                            <td>调试、计费</td>
                            <td>建议集成OpenTelemetry span propagation</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="card mt-4" data-aos="fade-up">
                <div class="card-header">我怎么看</div>
                <div class="card-body">
                    <ul>
                        <li><strong>意义：</strong>把"一个LLM + 一把工具"升级为"智能体网"，为长链任务（代码PR–CI–部署）提供原生协议支撑。</li>
                        <li><strong>风险：</strong>引入分布式复杂性、循环依赖及预算爆炸，需要预算上限与超时熔断成为协议一级公民。</li>
                        <li><strong>机会：</strong>第三方可做Graph Router（观察-路由-限流）或Namespace Registry，类似API Gateway市场。</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <div class="separator" data-aos="fade">⸻</div>
        
        <section data-aos="fade-up">
            <h2 class="section-title"><i class="fas fa-users-cog"></i> Interactive Workflows</h2>
            
            <div class="card" data-aos="fade-up">
                <div class="card-header">背景</div>
                <div class="card-body">
                    <p>Roadmap指向"human-in-the-loop体验、细粒度权限、与终端用户直接沟通的标准模式"。Medium评述将其列为2025 H1 MCP三大里程碑之一。</p>
                </div>
            </div>
            
            <h3>关键能力草案</h3>
            
            <div class="card-group">
                <div class="card" data-aos="fade-up" data-aos-delay="100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-wpforms"></i> Elicitation / Form-Fill</h5>
                        <p class="card-text">Server可回弹"表单"请求，客户端渲染UI让人类补充结构化字段，再回传toolCallContinue。相关PR #314/#315探讨了多轮交互语义。</p>
                    </div>
                </div>
                
                <div class="card" data-aos="fade-up" data-aos-delay="200">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-shield-alt"></i> Granular Permissioning</h5>
                        <p class="card-text">Server为Tool标注risk, cost，客户端可根据用户策略弹窗确认或走审批队列（GitHub Issue #97给出了outputSchema + audience的细粒度示例）。</p>
                    </div>
                </div>
                
                <div class="card" data-aos="fade-up" data-aos-delay="300">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-stream"></i> Partial / Streaming Results</h5>
                        <p class="card-text">长任务可分块返回，先把progress、partial结果流给UI，再由最终结果替换或补全。</p>
                    </div>
                </div>
                
                <div class="card" data-aos="fade-up" data-aos-delay="400">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-user-check"></i> Human Oversight Scoring</h5>
                        <p class="card-text">社区出现Human-Loop Server，通过风险/权限/复杂度打分决定是否暂停等待人工批准。</p>
                    </div>
                </div>
            </div>
            
            <h3 class="mt-4">场景示例</h3>
            
            <div class="row" data-aos="fade-up">
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-lock"></i> 安全敏感操作</h5>
                            <p class="card-text">企业财务Bot在调用"资金划拨"Tool前强制人工二次确认。Axios报道指出，安全与隐私是MCP企业落地最大顾虑。</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-paint-brush"></i> 半结构化创作</h5>
                            <p class="card-text">设计助手在生成整页Figma布局前，请设计师在Web UI内快速拖调组件顺序，然后继续自动化。博客示例称之为"Your Guy in the Chair"模式。</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-hospital-user"></i> 数据治理</h5>
                            <p class="card-text">对医疗记录批改，模型需医生复审批注后才能写回EMR，符合HITL合规要求。</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-4" data-aos="fade-up">
                <div class="card-header">个人评价</div>
                <div class="card-body">
                    <ul>
                        <li><strong>必要性：</strong>解决"模型冲动执行"+"用户不放心"矛盾，是迈向企业级闭环的前置条件。</li>
                        <li><strong>挑战：</strong>UI/UX标准如何抽象成协议字段而不过度约束前端框架？另需兼容移动端与CLI纯文本场景。</li>
                        <li><strong>趋势：</strong>随着A2A推出的Intent Proposal → Approval → Execution三段式流程，MCP很可能对齐类似状态机，或允许通过扩展字段承载A2A-like状态；二者最终或以桥接层融合。</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <div class="separator" data-aos="fade">⸻</div>
        
        <section data-aos="fade-up">
            <h2 class="section-title"><i class="fas fa-project-diagram"></i> 组合意义与展望</h2>
            
            <div class="bg-gradient" data-aos="fade-up">
                <p><strong>双螺旋演进：</strong>Agent Graphs解决"多节点编排"，Interactive Workflows解决"敏感节点人工兜底"，共同将MCP推向"可信自治代理网"。</p>
                
                <h4>对生态的影响：预计会催生两类服务 —</h4>
                <ol>
                    <li><strong>Graph-Router SaaS：</strong>提供跨命名空间调度、预算管控与OTel Trace；</li>
                    <li><strong>Workflow Surface SDK：</strong>在React/Flutter/CLI等端快速渲染审批弹窗与表单。</li>
                </ol>
                
                <p><strong>与A2A的边界：</strong>短期"Tool调用用MCP、Agent编排用A2A"，长期若A2A在企业权限链条上跑通，MCP可能复用其状态语义实现轻量兼容，形成interop-suite。</p>
            </div>
        </section>
        
        <div class="separator" data-aos="fade">⸻</div>
        
        <section data-aos="fade-up">
            <h2 class="section-title"><i class="fas fa-tools"></i> 给开发者的实用建议</h2>
            
            <div class="row" data-aos="fade-up">
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">1. 提前规划namespace</h5>
                            <p class="card-text">采用反向域名或org/tool体系，未来减少Agent Graph合并痛点。</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">2. 把HITL设计为可插拔</h5>
                            <p class="card-text">Tool元数据中预留risk、cost、requiresApproval字段，方便Roadmap新字段落地。</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">3. 引入Trace ID</h5>
                            <p class="card-text">在每层代理追加trace-id，配合OTel先行布点，待官方标准确定可平滑迁移。</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">4. 实验Graph Prototype</h5>
                            <p class="card-text">用社区mcp-agent框架 + LangGraph搭2-3层代理，验证命名冲突与进度通知传递链路。</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-12 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">5. 关注PR标签feat/interactive</h5>
                            <p class="card-text">每周浏览MCP GitHub Discussions与PR，测试#356、#382、#383等草案以抢占心智。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <div class="bg-gradient mt-5" data-aos="fade-up">
            <blockquote class="mb-0">
                <p class="mb-0">一句话总结：Agent Graphs让MCP能"横向扩张"、Interactive Workflows让它"纵向深入"触达人类决策；二者共同奠定下一阶段"安全、自主、可观测"的多智能体运行时。</p>
            </blockquote>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
    </script>
</body>
</html> 